<html>
  <head>
    <link rel="stylesheet" href="./xterm.css" />
    <script src="./xterm.js"></script>
    <title>Command Prompt</title>
  </head>
  <body>
    <div id="terminal"></div>
    <script>
      const cmds = {
        "help": function() {
          term.write(cmds.keys().join("\r\n"));
        },
        "echo": function(text) {
          term.write(text.join(" "));
        }
      };
      var term = new Terminal();
      var command = "";
      var commandArr = {};
      term.open(document.getElementById("terminal"));
      term.write("webuser@localhost $ ");
      term.onData(function (data) {
        if (data == "\r") {
          if (command == "") {
            term.write("\r\nwebuser@localhost $ ");
            command = "";
            break;
          }
          try {
            commandArr = command.split(" ");
            cmds[commandArr[0]](commandArr.slice(1));
          } catch(ReferenceError) {
            try {
              cmds[command]();
            } catch(ReferenceError) {
              term.write(`\r\nCommand '${commandArr[0]}' not found!`);
            }
          }
          term.write("\r\nwebuser@localhost $ ");
          command = "";
        } else if (data == "\u007F") {
          if (term._core.buffer.x > 20) {
            term.write("\b \b");
            if (command.length > 0) {
              command = command.substr(0, command.length - 1);
            }
          }
        } else {
          term.write(data);
          command += data;
        }
      });
    </script>
  </body>
</html>
